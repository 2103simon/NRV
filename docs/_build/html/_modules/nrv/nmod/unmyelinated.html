<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" />

    <!-- Generated with Sphinx 6.2.1 and Furo 2023.05.20 -->
        <title>nrv.nmod.unmyelinated - NeuRon Virtualizer (NRV) 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=e6660623a769aa55fea372102b9bf3151b292993" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f0f0f0;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #232629;
  --color-code-foreground: #cccccc;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #232629;
  --color-code-foreground: #cccccc;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">NeuRon Virtualizer (NRV) 1.0.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">NeuRon Virtualizer (NRV) 1.0.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../modules.html">nrv</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of nrv</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../nrv.html">nrv package</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of nrv package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nrv.backend.html">nrv.backend package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrv.fmod.html">nrv.fmod package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrv.nmod.html">nrv.nmod package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrv.optim.html">nrv.optim package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrv.utils.html">nrv.utils package</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <h1>Source code for nrv.nmod.unmyelinated</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">NRV-unmyelinated</span>
<span class="sd">Authors: Florian Kolbl / Roland Giraud / Louis Regnacq / Thomas Couppey</span>
<span class="sd">(c) ETIS - University Cergy-Pontoise - CNRS</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">.axons</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">..backend.log_interface</span> <span class="kn">import</span> <span class="n">rise_error</span><span class="p">,</span> <span class="n">rise_warning</span><span class="p">,</span> <span class="n">pass_info</span>

<div class="viewcode-block" id="unmyelinated"><a class="viewcode-back" href="../../../nrv.nmod.html#nrv.nmod.unmyelinated.unmyelinated">[docs]</a><span class="k">class</span> <span class="nc">unmyelinated</span><span class="p">(</span><span class="n">axon</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Unmyelineated axon class. Automatic refinition of all neuron sections and properties. User-friendly object including model definition</span>
<span class="sd">    Inherit from axon class. see axon for further detail.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;Rattay_Aberham&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">Nrec</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Nsec</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> \
        <span class="n">Nseg_per_sec</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">freq_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mesh_shape</span><span class="o">=</span><span class="s1">&#39;plateau_sigmoid&#39;</span><span class="p">,</span> <span class="n">alpha_max</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>\
         <span class="n">d_lambda</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">v_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ID</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=-</span><span class="mi">40</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        initialisation of an unmyelinted axon</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        y               : float</span>
<span class="sd">            y coordinate for the axon, in um</span>
<span class="sd">        z               : float</span>
<span class="sd">            z coordinate for the axon, in um</span>
<span class="sd">        d               : float</span>
<span class="sd">            axon diameter, in um</span>
<span class="sd">        L               : float</span>
<span class="sd">            axon length along the x axins, in um</span>
<span class="sd">        model           : str</span>
<span class="sd">            choice of conductance based model, possibly:</span>
<span class="sd">                &#39;HH&#39;                : original squid giant axon model, warning - low temperature model, not adapted to mamalian modeling</span>
<span class="sd">                &#39;Rattay_Aberham&#39;    : Rattay Aberham model, see [1] for details</span>
<span class="sd">                &#39;Sundt&#39;             : Sundt model, see [1] for details</span>
<span class="sd">                &#39;Tigerholm&#39;         : Tigerholm model, see [1] for details</span>
<span class="sd">                &#39;Schild_94&#39;         : Schild 1994 model, see [1] for details</span>
<span class="sd">                &#39;Schild_97&#39;         : Schild 1997 model, see [1] for details</span>
<span class="sd">        dt              : float</span>
<span class="sd">            computation step for simulations, in ms. By default equal to 1 us</span>
<span class="sd">        Nrec            : int</span>
<span class="sd">            Number of points along the axon to record for simulation results. Between 0 and the number of segment, if set to 0, all segments are recorded</span>
<span class="sd">        Nsec            : int</span>
<span class="sd">            Number of sections in the axon, by default 1. Usefull to create umnyelinated axons with a variable segment density</span>
<span class="sd">        Nseg_per_sec    : int</span>
<span class="sd">            Number of segment per section in the axon. If set to 0, the number of segment is automatically computed using d-lambda rule and following paramters. If set by user, please use odd numbers</span>
<span class="sd">        freq            : float</span>
<span class="sd">            Frequency used for the d-lmbda rule, corresponding to the maximum membrane current frequency, by default set to 100 Hz</span>
<span class="sd">        freq_min        : float</span>
<span class="sd">            Minimal frequency fot the d-lambda rule when using an irregular number of segment along the axon, if set to 0, all sections have the same frequency determined by the previous parameter</span>
<span class="sd">        mesh_shape      : str</span>
<span class="sd">            Shape of the frequencial distribution for the dlmabda rule along the axon, pick between:</span>
<span class="sd">                &#39;pyramidal&#39;         -&gt; min frequencies on both sides and linear increase up to the middle at the maximum frequency</span>
<span class="sd">                &#39;sigmoid&#39;           -&gt; same a befor with sigmoid increase instead of linear</span>
<span class="sd">                &#39;plateau&#39;           -&gt; sale as pyramidal except the max frequency is holded on a central plateau</span>
<span class="sd">                &#39;plateau_sigmoid&#39;   -&gt; same as previous with sigmoid increase</span>
<span class="sd">        alpha_max       : float</span>
<span class="sd">            Proportion of the axon set to the maximum frequency for plateau shapes, by default set to 0.3</span>
<span class="sd">        d_lambda        : float</span>
<span class="sd">            value of d-lambda for the dlambda rule,</span>
<span class="sd">        v_init          : float</span>
<span class="sd">            Initial value of the membrane voltage in mV, set None to get an automatically model attributed value</span>
<span class="sd">        T               : float</span>
<span class="sd">            temperature in C, set None to get an automatically model attributed value</span>
<span class="sd">        ID              : int</span>
<span class="sd">            axon ID, by default set to 0,</span>
<span class="sd">        threshold       : float</span>
<span class="sd">            voltage threshold in mV for further spike detection in post-processing, by defautl set to -40mV, see post-processing files for further help</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        reference [1] corresponds to:</span>
<span class="sd">            Pelot, N. A., Catherall, D. C., Thio, B. J., Titus, N. D., Liang, E. D., Henriquez, C. S., &amp; Grill, W. M. (2021). Excitation properties of computational models of unmyelinated peripheral axons. Journal of neurophysiology, 125(1), 86-104.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">Nseg_per_sec</span><span class="o">=</span><span class="n">Nseg_per_sec</span><span class="p">,</span>\
            <span class="n">freq</span><span class="o">=</span><span class="n">freq</span><span class="p">,</span> <span class="n">freq_min</span><span class="o">=</span><span class="n">freq_min</span><span class="p">,</span> <span class="n">mesh_shape</span><span class="o">=</span><span class="n">mesh_shape</span><span class="p">,</span> <span class="n">alpha_max</span><span class="o">=</span><span class="n">alpha_max</span><span class="p">,</span> \
            <span class="n">d_lambda</span><span class="o">=</span><span class="n">d_lambda</span><span class="p">,</span> <span class="n">v_init</span><span class="o">=</span><span class="n">v_init</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">ID</span><span class="o">=</span><span class="n">ID</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span> <span class="o">=</span> <span class="n">Nsec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span> <span class="o">=</span> <span class="n">Nrec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">myelinated</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">unmyelinated_models</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;Rattay_Aberham&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__compute_axon_parameters</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__compute_axon_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        generate axon from parameters set by user</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">## Handling v_init</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_init</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># model driven</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;HH&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">v_init</span> <span class="o">=</span> <span class="o">-</span><span class="mf">67.5</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Rattay_Aberham&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">v_init</span> <span class="o">=</span> <span class="o">-</span><span class="mi">70</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Sundt&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">v_init</span> <span class="o">=</span> <span class="o">-</span><span class="mi">60</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Tigerholm&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">v_init</span> <span class="o">=</span> <span class="o">-</span><span class="mi">62</span>   <span class="c1"># -55 in Pelot 2020, changed by FK 19/01/2021</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">v_init</span> <span class="o">=</span> <span class="o">-</span><span class="mi">70</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># user driven</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v_init</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_init</span>
        <span class="c1">## Handling temperature</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># model driven</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;HH&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="mi">32</span> <span class="c1"># original HH model, cold model, maximal temperature at which spike propagation is not altered</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="mi">37</span> <span class="c1"># mamalian models</span>

        <span class="c1"># create and connect (if more than 1) sections</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span> <span class="o">=</span> <span class="p">[</span><span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Section</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;U_axon[</span><span class="si">%d</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> \
            <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">sec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">:</span>
            <span class="c1"># morphologic parameters</span>
            <span class="n">sec</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span>
            <span class="n">sec</span><span class="o">.</span><span class="n">diam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c1"># implement neuron mechanisms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__set_model</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>
        <span class="c1"># define the geometry of the axon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_axon__define_shape</span><span class="p">()</span>
        <span class="c1"># define the number of segments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__set_Nseg</span><span class="p">()</span>
        <span class="c1"># get nodes positions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__get_seg_positions</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__get_rec_positions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">)</span>

<div class="viewcode-block" id="unmyelinated.save"><a class="viewcode-back" href="../../../nrv.nmod.html#nrv.nmod.unmyelinated.unmyelinated.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;axon.json&#39;</span><span class="p">,</span> <span class="n">extracel_context</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">intracel_context</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rec_context</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return axon as dictionary and eventually save it as json file</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        save    : bool</span>
<span class="sd">            if True, save in json files</span>
<span class="sd">        fname   : str</span>
<span class="sd">            Path and Name of the saving file, by default &#39;axon.json&#39;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax_dic : dict</span>
<span class="sd">            dictionary containing all information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ax_dic</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">extracel_context</span><span class="o">=</span><span class="n">extracel_context</span><span class="p">,</span> <span class="n">intracel_context</span><span class="o">=</span><span class="n">intracel_context</span><span class="p">,</span> <span class="n">rec_context</span><span class="o">=</span><span class="n">rec_context</span><span class="p">)</span>

        <span class="n">ax_dic</span><span class="p">[</span><span class="s1">&#39;myelinated&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">myelinated</span>
        <span class="n">ax_dic</span><span class="p">[</span><span class="s1">&#39;Nsec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span>
        <span class="n">ax_dic</span><span class="p">[</span><span class="s1">&#39;Nrec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span>
        <span class="n">ax_dic</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span>

        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="n">json_dump</span><span class="p">(</span><span class="n">ax_dic</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax_dic</span></div>

<div class="viewcode-block" id="unmyelinated.load"><a class="viewcode-back" href="../../../nrv.nmod.html#nrv.nmod.unmyelinated.unmyelinated.load">[docs]</a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">extracel_context</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">intracel_context</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rec_context</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load all axon properties from a dictionary or a json file</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data    : str or dict</span>
<span class="sd">            json file path or dictionary containing axon information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">ax_dic</span> <span class="o">=</span> <span class="n">json_load</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">ax_dic</span> <span class="o">=</span> <span class="n">data</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">extracel_context</span><span class="o">=</span><span class="n">extracel_context</span><span class="p">,</span> <span class="n">intracel_context</span><span class="o">=</span><span class="n">intracel_context</span><span class="p">,</span> <span class="n">rec_context</span><span class="o">=</span><span class="n">rec_context</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">myelinated</span> <span class="o">=</span> <span class="n">ax_dic</span><span class="p">[</span><span class="s1">&#39;myelinated&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span> <span class="o">=</span> <span class="n">ax_dic</span><span class="p">[</span><span class="s1">&#39;Nsec&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span> <span class="o">=</span> <span class="n">ax_dic</span><span class="p">[</span><span class="s1">&#39;Nrec&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">ax_dic</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">unmyelinated_models</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">ax_dic</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;Rattay_Aberham&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__compute_axon_parameters</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">intracel_context</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ax_dic</span><span class="p">[</span><span class="s1">&#39;intra_current_stim_positions&#39;</span><span class="p">])):</span>
                <span class="n">position</span> <span class="o">=</span> <span class="n">ax_dic</span><span class="p">[</span><span class="s1">&#39;intra_current_stim_positions&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                <span class="n">stim_start</span> <span class="o">=</span> <span class="n">ax_dic</span><span class="p">[</span><span class="s1">&#39;intra_current_stim_starts&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                <span class="n">duration</span> <span class="o">=</span> <span class="n">ax_dic</span><span class="p">[</span><span class="s1">&#39;intra_current_stim_durations&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                <span class="n">amplitude</span> <span class="o">=</span> <span class="n">ax_dic</span><span class="p">[</span><span class="s1">&#39;intra_current_stim_amplitudes&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insert_I_Clamp</span><span class="p">(</span><span class="n">position</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="n">stim_start</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ax_dic</span><span class="p">[</span><span class="s1">&#39;intra_voltage_stim_stimulus&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">position</span> <span class="o">=</span> <span class="n">ax_dic</span><span class="p">[</span><span class="s1">&#39;intra_voltage_stim_position&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">stim</span> <span class="o">=</span> <span class="n">stimulus</span><span class="p">()</span>
                <span class="n">stim</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">ax_dic</span><span class="p">[</span><span class="s1">&#39;intra_voltage_stim_stimulus&#39;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insert_V_Clamp</span><span class="p">(</span><span class="n">position</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="n">stim</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__set_Nseg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        sets the number of segment, either with the number chosen by user,</span>
<span class="sd">        or using the dlambda rule, or using the dlambda rule with a frequency array</span>
<span class="sd">        of different shapes (see create_Nseg_freq_shape() help for more details on shapes)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq_min</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># uniform meshing</span>
            <span class="c1"># compute the correct number of segments if needed, or take the one given by user</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nseg_per_sec</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">Nseg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nseg_per_sec</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Nseg</span> <span class="o">=</span> <span class="n">d_lambda_rule</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span>\
                <span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="c1"># set the number of segment for all declared sections</span>
            <span class="k">for</span> <span class="n">sec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">:</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">nseg</span> <span class="o">=</span> <span class="n">Nseg</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Schild_94&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Schild_97&#39;</span><span class="p">:</span>
                    <span class="n">sec</span><span class="o">.</span><span class="n">nseg_caintscale</span> <span class="o">=</span> <span class="n">Nseg</span>
                    <span class="n">sec</span><span class="o">.</span><span class="n">nseg_caextscale</span> <span class="o">=</span> <span class="n">Nseg</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Nseg</span> <span class="o">+=</span> <span class="n">Nseg</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># non uniform meshing</span>
            <span class="n">freqs</span> <span class="o">=</span> <span class="n">create_Nseg_freq_shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq_min</span><span class="p">,</span>\
                <span class="bp">self</span><span class="o">.</span><span class="n">alpha_max</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="p">):</span>
                <span class="n">Nseg</span> <span class="o">=</span> <span class="n">d_lambda_rule</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_lambda</span><span class="p">,</span> <span class="n">freqs</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">nseg</span> <span class="o">=</span> <span class="n">Nseg</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Schild_94&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Schild_97&#39;</span><span class="p">:</span>
                    <span class="n">sec</span><span class="o">.</span><span class="n">nseg_caintscale</span> <span class="o">=</span> <span class="n">Nseg</span>
                    <span class="n">sec</span><span class="o">.</span><span class="n">nseg_caextscale</span> <span class="o">=</span> <span class="n">Nseg</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Nseg</span> <span class="o">+=</span> <span class="n">Nseg</span>

    <span class="k">def</span> <span class="nf">__get_seg_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get all the computation position of the axon. This corresponds to the positions of the segment</span>
<span class="sd">        without the duplicates of connected sections</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x_offset</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">sec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="n">sec</span><span class="o">.</span><span class="n">allseg</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="p">[]:</span>
                    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">sec</span><span class="o">.</span><span class="n">L</span><span class="p">)</span> <span class="o">+</span> <span class="n">x_offset</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">x_seg</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">sec</span><span class="o">.</span><span class="n">L</span><span class="p">)</span> <span class="o">+</span> <span class="n">x_offset</span>
                    <span class="k">if</span> <span class="n">x_seg</span> <span class="o">!=</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_seg</span><span class="p">)</span>
            <span class="n">x_offset</span> <span class="o">+=</span> <span class="n">sec</span><span class="o">.</span><span class="n">L</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__get_rec_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nrec</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get recording x-coordinates and relative positions, for internal use only</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Nrec    : int</span>
<span class="sd">            number of points to record in the axon during the simulation, can be chosen between 3 and maximum the number of programmed segments + 2 (both sides)</span>
<span class="sd">            or will be by default set to the nearest value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="k">if</span> <span class="n">Nrec</span> <span class="o">&lt;</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">Nrec</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># at least, 3 positions will be memorized along the axon (extrema and middle)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x_rec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">Nrec</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">Nrec</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nseg</span><span class="p">:</span> <span class="c1"># record on all nodes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nseg</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">allseg</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
                <span class="c1"># delete last position as it will be a dupplicate with next section first seg</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1"># for the last section only, add the max position</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x_rec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span> <span class="o">=</span> <span class="n">Nrec</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">remaining_recs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">remaining_recs</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">rec</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">rec</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x_rec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__set_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds the passive, Hodgking Huxley and extracellular mechanisms,</span>
<span class="sd">        set values to to one given by user at the initialisation or default ones. For internal use only.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">sec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">:</span>
            <span class="c1"># insert mechanisms</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;HH&#39;</span><span class="p">,</span> <span class="s1">&#39;Rattay_Aberham&#39;</span><span class="p">,</span> <span class="s1">&#39;Sundt&#39;</span><span class="p">]:</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;pas&#39;</span><span class="p">)</span>
            <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;extracellular&#39;</span><span class="p">)</span>
            <span class="n">sec</span><span class="o">.</span><span class="n">xg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e10</span> <span class="c1"># short circuit, no myelin</span>
            <span class="n">sec</span><span class="o">.</span><span class="n">xc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c1"># short circuit, no myelin</span>
            <span class="c1">## Except for HH, the following code is directly take from modelDB: https://senselab.med.yale.edu/ModelDB/showmodel.cshtml?model=266498#tabs-1</span>
            <span class="c1">## Pelot N (2020) Excitation Properties of Computational Models of Unmyelinated Peripheral Axons J Neurophysiology</span>
            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;HH&#39;</span><span class="p">:</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;hh&#39;</span><span class="p">)</span>
                <span class="c1"># explicit mechanisms settings</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">cm</span> <span class="o">=</span> <span class="mf">1.0</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">Ra</span> <span class="o">=</span> <span class="mf">200.0</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">gnabar_hh</span> <span class="o">=</span> <span class="mf">0.120</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">gkbar_hh</span> <span class="o">=</span> <span class="mf">0.036</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">gl_hh</span> <span class="o">=</span> <span class="mf">0.0003</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">ena</span> <span class="o">=</span> <span class="mi">50</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">ek</span> <span class="o">=</span> <span class="o">-</span><span class="mi">77</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">el_hh</span> <span class="o">=</span> <span class="o">-</span><span class="mf">54.3</span>
            <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Rattay_Aberham&#39;</span><span class="p">:</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;RattayAberham&#39;</span><span class="p">)</span> <span class="c1"># Model adjusted for a resting potential of -70mV instead of 0 (subtract Vrest from each reversal potential)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">Ra</span> <span class="o">=</span> <span class="mi">100</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">cm</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="o">-</span><span class="mi">70</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">ena</span> <span class="o">=</span> <span class="mi">45</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">ek</span> <span class="o">=</span> <span class="o">-</span><span class="mi">82</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">e_pas</span> <span class="o">=</span> <span class="o">-</span><span class="mi">70</span>
            <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Sundt&#39;</span><span class="p">:</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;nahh&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">gnabar_nahh</span> <span class="o">=</span> <span class="mf">.04</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">mshift_nahh</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>            <span class="c1"># NaV1.7/1.8 channelshift</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">hshift_nahh</span> <span class="o">=</span> <span class="mi">6</span>             <span class="c1"># NaV1.7/1.8 channelshift</span>

                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;borgkdr&#39;</span><span class="p">)</span>           <span class="c1"># insert delayed rectifier K channels</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">gkdrbar_borgkdr</span> <span class="o">=</span> <span class="mf">.04</span>       <span class="c1"># density of K channels</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">ek</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span>                    <span class="c1"># K equilibrium potential</span>

                <span class="n">sec</span><span class="o">.</span><span class="n">g_pas</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">10000</span>             <span class="c1"># set Rm = 10000 ohms-cm2</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">Ra</span> <span class="o">=</span> <span class="mi">100</span>                    <span class="c1"># intracellular resistance</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="o">-</span><span class="mi">60</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">e_pas</span> <span class="o">=</span> <span class="n">sec</span><span class="o">.</span><span class="n">v</span> <span class="o">+</span> <span class="p">(</span><span class="n">sec</span><span class="o">.</span><span class="n">ina</span> <span class="o">+</span> <span class="n">sec</span><span class="o">.</span><span class="n">ik</span><span class="p">)</span><span class="o">/</span><span class="n">sec</span><span class="o">.</span><span class="n">g_pas</span>    <span class="c1"># calculate leak equilibrium potential</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Tigerholm&#39;</span><span class="p">:</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;ks&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">gbar_ks</span> <span class="o">=</span> <span class="mf">0.0069733</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;kf&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">gbar_kf</span> <span class="o">=</span> <span class="mf">0.012756</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">gbar_h</span> <span class="o">=</span> <span class="mf">0.0025377</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;nattxs&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">gbar_nattxs</span> <span class="o">=</span> <span class="mf">0.10664</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;nav1p8&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">gbar_nav1p8</span> <span class="o">=</span> <span class="mf">0.24271</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;nav1p9&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">gbar_nav1p9</span> <span class="o">=</span> <span class="mf">9.4779e-05</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;nakpump&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">smalla_nakpump</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0047891</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;kdrTiger&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">gbar_kdrTiger</span> <span class="o">=</span> <span class="mf">0.018002</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;kna&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">gbar_kna</span> <span class="o">=</span> <span class="mf">0.00042</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;naoi&#39;</span><span class="p">)</span>

                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;koi&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">theta_naoi</span> <span class="o">=</span> <span class="mf">0.029</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">theta_koi</span> <span class="o">=</span> <span class="mf">0.029</span>

                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;leak&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;extrapump&#39;</span><span class="p">)</span>

                <span class="n">sec</span><span class="o">.</span><span class="n">Ra</span> <span class="o">=</span> <span class="mf">35.5</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">cm</span> <span class="o">=</span> <span class="mf">1.</span>

                <span class="n">sec</span><span class="o">.</span><span class="n">celsiusT_ks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">celsiusT_kf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">celsiusT_h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">celsiusT_nattxs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">celsiusT_nav1p8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">celsiusT_nav1p9</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">celsiusT_nakpump</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">celsiusT_kdrTiger</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="o">-</span><span class="mi">55</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1"># Schild 94 or 97 models</span>
                <span class="n">R</span> <span class="o">=</span> <span class="mi">8314</span>
                <span class="n">F</span> <span class="o">=</span> <span class="mi">96500</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;leakSchild&#39;</span><span class="p">)</span>                        <span class="c1"># All mechanisms from Schild 1994 inserted into model</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;kd&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;ka&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;can&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;kds&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;kca&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;caextscale&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;caintscale&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;CaPump&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;NaCaPump&#39;</span><span class="p">)</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;NaKpumpSchild&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Schild_94&#39;</span><span class="p">:</span>
                    <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;naf&#39;</span><span class="p">)</span>
                    <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;nas&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;naf97mean&#39;</span><span class="p">)</span>
                    <span class="n">sec</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;nas97mean&#39;</span><span class="p">)</span>
                <span class="c1"># Ionic concentrations</span>
                <span class="c1">#cao0_ca_ion = 2.0                                      # not in section, adapter considering: https://neuronsimulator.github.io/nrn/rxd-tutorials/initialization.html</span>
                <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">cao0_ca_ion</span> <span class="o">=</span> <span class="mf">2.0</span>                              <span class="c1"># [mM] Initial Cao Concentration</span>
                <span class="c1">#cai0_ca_ion = 0.000117                                 # same as cao_ca_ion</span>
                <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">cai0_ca_ion</span> <span class="o">=</span> <span class="mf">0.000117</span>                         <span class="c1"># [mM] Initial Cai Concentrations</span>
                <span class="n">ko</span> <span class="o">=</span> <span class="mf">5.4</span>                                                <span class="c1"># [mM] External K Concentration</span>
                <span class="n">ki</span> <span class="o">=</span> <span class="mf">145.0</span>                                              <span class="c1"># [mM] Internal K Concentration</span>
                <span class="n">kstyle</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">ion_style</span><span class="p">(</span><span class="s2">&quot;k_ion&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>     <span class="c1"># Allows ek to be calculated manually</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">ek</span> <span class="o">=</span> <span class="p">((</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="o">+</span><span class="mf">273.15</span><span class="p">))</span><span class="o">/</span><span class="n">F</span><span class="p">)</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ko</span><span class="o">/</span><span class="n">ki</span><span class="p">)</span>        <span class="c1"># Manual Calculation of ek in order to use Schild F and R values</span>
                <span class="n">nao</span> <span class="o">=</span> <span class="mf">154.0</span>                                             <span class="c1"># [mM] External Na Concentration</span>
                <span class="n">nai</span> <span class="o">=</span> <span class="mf">8.9</span>                                               <span class="c1"># [mM] Internal Na Concentration</span>
                <span class="n">nastyle</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">ion_style</span><span class="p">(</span><span class="s2">&quot;na_ion&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># Allows ena to be calculated manually</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">ena</span> <span class="o">=</span> <span class="p">((</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="o">+</span><span class="mf">273.15</span><span class="p">))</span><span class="o">/</span><span class="n">F</span><span class="p">)</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nao</span><span class="o">/</span><span class="n">nai</span><span class="p">)</span>     <span class="c1"># Manual Calculation of ena in order to use Schild F and R values</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Schild_97&#39;</span><span class="p">:</span>
                    <span class="n">sec</span><span class="o">.</span><span class="n">gbar_naf97mean</span> <span class="o">=</span> <span class="mf">0.022434928</span>                    <span class="c1"># [S/cm^2] This block sets the conductance to the conductances in Schild 1997</span>
                    <span class="n">sec</span><span class="o">.</span><span class="n">gbar_nas97mean</span> <span class="o">=</span> <span class="mf">0.022434928</span>
                    <span class="n">sec</span><span class="o">.</span><span class="n">gbar_kd</span> <span class="o">=</span> <span class="mf">0.001956534</span>
                    <span class="n">sec</span><span class="o">.</span><span class="n">gbar_ka</span> <span class="o">=</span> <span class="mf">0.001304356</span>
                    <span class="n">sec</span><span class="o">.</span><span class="n">gbar_kds</span> <span class="o">=</span> <span class="mf">0.000782614</span>
                    <span class="n">sec</span><span class="o">.</span><span class="n">gbar_kca</span> <span class="o">=</span> <span class="mf">0.000913049</span>
                    <span class="n">sec</span><span class="o">.</span><span class="n">gbar_can</span> <span class="o">=</span> <span class="mf">0.000521743</span>
                    <span class="n">sec</span><span class="o">.</span><span class="n">gbar_cat</span> <span class="o">=</span> <span class="mf">0.00018261</span>
                    <span class="n">sec</span><span class="o">.</span><span class="n">gbna_leakSchild</span> <span class="o">=</span> <span class="mf">1.8261e-05</span>
                    <span class="n">sec</span><span class="o">.</span><span class="n">gbca_leakSchild</span> <span class="o">=</span> <span class="mf">9.13049e-06</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">Ra</span> <span class="o">=</span> <span class="mi">100</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">cm</span> <span class="o">=</span> <span class="mf">1.326291192</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="o">-</span><span class="mi">48</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">L_caintscale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span>
                <span class="n">sec</span><span class="o">.</span><span class="n">L_caextscale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span>

    <span class="c1">###############################</span>
    <span class="c1">## Intracellular stimulation ##</span>
    <span class="c1">###############################</span>
<div class="viewcode-block" id="unmyelinated.insert_I_Clamp"><a class="viewcode-back" href="../../../nrv.nmod.html#nrv.nmod.unmyelinated.unmyelinated.insert_I_Clamp">[docs]</a>    <span class="k">def</span> <span class="nf">insert_I_Clamp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">t_start</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Insert a I clamp stimulation</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        position    : float</span>
<span class="sd">            relative position over the axon</span>
<span class="sd">        t_start     : float</span>
<span class="sd">            starting time, in ms</span>
<span class="sd">        duration    : float</span>
<span class="sd">            duration of the pulse, in ms</span>
<span class="sd">        amplitude   : float</span>
<span class="sd">            amplitude of the pulse (nA)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># adapt position to the number of sections</span>
        <span class="n">portion_length</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span>
        <span class="n">stim_sec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">position</span><span class="o">/</span><span class="n">portion_length</span><span class="p">))</span>
        <span class="n">stim_pos</span> <span class="o">=</span> <span class="p">(</span><span class="n">position</span><span class="o">/</span><span class="n">portion_length</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">position</span><span class="o">/</span><span class="n">portion_length</span><span class="p">)</span>
        <span class="c1"># add the stimulation to the axon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intra_current_stim</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">IClamp</span><span class="p">(</span><span class="n">stim_pos</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">stim_sec</span><span class="p">]))</span>
        <span class="c1"># modify the stimulation parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intra_current_stim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="n">t_start</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intra_current_stim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dur</span> <span class="o">=</span> <span class="n">duration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intra_current_stim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">amp</span> <span class="o">=</span> <span class="n">amplitude</span>
        <span class="c1"># save the stimulation parameter for results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intra_current_stim_positions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">position</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intra_current_stim_starts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t_start</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intra_current_stim_durations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intra_current_stim_amplitudes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">amplitude</span><span class="p">)</span></div>

<div class="viewcode-block" id="unmyelinated.insert_V_Clamp"><a class="viewcode-back" href="../../../nrv.nmod.html#nrv.nmod.unmyelinated.unmyelinated.insert_V_Clamp">[docs]</a>    <span class="k">def</span> <span class="nf">insert_V_Clamp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">stimulus</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Insert a V clamp stimulation</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        position    : float</span>
<span class="sd">            relative position over the axon</span>
<span class="sd">        stimulus    : stimulus object</span>
<span class="sd">            stimulus for the clamp, see Stimulus.py for more information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># adapt position to the number of sections</span>
        <span class="n">portion_length</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span>
        <span class="n">stim_sec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">position</span><span class="o">/</span><span class="n">portion_length</span><span class="p">))</span>
        <span class="n">stim_pos</span> <span class="o">=</span> <span class="p">(</span><span class="n">position</span><span class="o">/</span><span class="n">portion_length</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">position</span><span class="o">/</span><span class="n">portion_length</span><span class="p">)</span>
        <span class="c1"># add the stimulation to the axon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intra_voltage_stim</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">VClamp</span><span class="p">(</span><span class="n">stim_pos</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">stim_sec</span><span class="p">])</span>
        <span class="c1"># save the stimulation parameter for results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intra_current_stim_position</span> <span class="o">=</span> <span class="n">position</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span>
        <span class="c1"># save the stimulus for later use</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intra_voltage_stim_stimulus</span> <span class="o">=</span> <span class="n">stimulus</span>
        <span class="c1"># set fake duration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intra_voltage_stim</span><span class="o">.</span><span class="n">dur</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e9</span></div>

    <span class="c1">##############################</span>
    <span class="c1">## Result recording methods ##</span>
    <span class="c1">##############################</span>
<div class="viewcode-block" id="unmyelinated.set_membrane_voltage_recorders"><a class="viewcode-back" href="../../../nrv.nmod.html#nrv.nmod.unmyelinated.unmyelinated.set_membrane_voltage_recorders">[docs]</a>    <span class="k">def</span> <span class="nf">set_membrane_voltage_recorders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prepare the membrane voltage recording. For internal use only.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vreclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">vrec</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_v</span><span class="p">,</span>\
                    <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vreclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vrec</span><span class="p">)</span></div>

<div class="viewcode-block" id="unmyelinated.get_membrane_voltage"><a class="viewcode-back" href="../../../nrv.nmod.html#nrv.nmod.unmyelinated.unmyelinated.get_membrane_voltage">[docs]</a>    <span class="k">def</span> <span class="nf">get_membrane_voltage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the membrane voltage at the end of simulation. For internal use only.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">):</span>
            <span class="n">vax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vreclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">vax</span></div>

<div class="viewcode-block" id="unmyelinated.set_membrane_current_recorders"><a class="viewcode-back" href="../../../nrv.nmod.html#nrv.nmod.unmyelinated.unmyelinated.set_membrane_current_recorders">[docs]</a>    <span class="k">def</span> <span class="nf">set_membrane_current_recorders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prepare the membrane current recording. For internal use only.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ireclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">i_mem_rec</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span>\
                    <span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_i_membrane</span><span class="p">,</span>\
                    <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ireclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i_mem_rec</span><span class="p">)</span></div>

<div class="viewcode-block" id="unmyelinated.get_membrane_current"><a class="viewcode-back" href="../../../nrv.nmod.html#nrv.nmod.unmyelinated.unmyelinated.get_membrane_current">[docs]</a>    <span class="k">def</span> <span class="nf">get_membrane_current</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the membrane current at the end of simulation. For internal use only.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">iax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">):</span>
            <span class="n">iax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ireclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">iax</span></div>

<div class="viewcode-block" id="unmyelinated.set_ionic_current_recorders"><a class="viewcode-back" href="../../../nrv.nmod.html#nrv.nmod.unmyelinated.unmyelinated.set_ionic_current_recorders">[docs]</a>    <span class="k">def</span> <span class="nf">set_ionic_current_recorders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prepare the ionic currents recording. For internal use only.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;HH&#39;</span><span class="p">,</span> <span class="s1">&#39;Rattay_Aberham&#39;</span><span class="p">,</span> <span class="s1">&#39;Sundt&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">i_na_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">i_k_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">i_l_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                    <span class="n">i_na_rec</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span>\
                        <span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_nai</span><span class="p">,</span>\
                         <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">i_k_rec</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span>\
                        <span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_ki</span><span class="p">,</span>\
                        <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">i_l_rec</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span>\
                        <span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_i_pas</span><span class="p">,</span>\
                        <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">i_na_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i_na_rec</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">i_k_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i_k_rec</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">i_l_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i_l_rec</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">i_na_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">i_k_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">i_ca_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">i_l_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                    <span class="n">i_na_rec</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_nai</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">i_k_rec</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_ki</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">i_ca_rec</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_cai</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">i_na_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i_na_rec</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">i_k_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i_k_rec</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">i_ca_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i_ca_rec</span><span class="p">)</span></div>

<div class="viewcode-block" id="unmyelinated.get_ionic_current"><a class="viewcode-back" href="../../../nrv.nmod.html#nrv.nmod.unmyelinated.unmyelinated.get_ionic_current">[docs]</a>    <span class="k">def</span> <span class="nf">get_ionic_current</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the ionic currents at the end of simulation. For internal use only.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;HH&#39;</span><span class="p">,</span> <span class="s1">&#39;Rattay_Aberham&#39;</span><span class="p">,</span> <span class="s1">&#39;Sundt&#39;</span><span class="p">]:</span>
            <span class="n">i_na_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">i_k_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">i_l_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">):</span>
                <span class="n">i_na_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i_na_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">i_k_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i_k_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">i_l_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i_l_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">i_na_ax</span><span class="p">,</span> <span class="n">i_k_ax</span><span class="p">,</span> <span class="n">i_l_ax</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i_na_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">i_k_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">i_ca_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">):</span>
                <span class="n">i_na_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i_na_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">i_k_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i_k_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">i_ca_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i_ca_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">i_na_ax</span><span class="p">,</span> <span class="n">i_k_ax</span><span class="p">,</span> <span class="n">i_ca_ax</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">results</span></div>

<div class="viewcode-block" id="unmyelinated.set_conductance_recorders"><a class="viewcode-back" href="../../../nrv.nmod.html#nrv.nmod.unmyelinated.unmyelinated.set_conductance_recorders">[docs]</a>    <span class="k">def</span> <span class="nf">set_conductance_recorders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prepare the membrane voltage recording. For internal use only.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;HH&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g_na_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g_k_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g_l_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                    <span class="n">g_na_rec</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span>\
                        <span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_gna_hh</span><span class="p">,</span>\
                        <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">g_k_rec</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span>\
                        <span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_gk_hh</span><span class="p">,</span>\
                        <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">g_l_rec</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span>\
                       <span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_gl_hh</span><span class="p">,</span>\
                       <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">g_na_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g_na_rec</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">g_k_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g_k_rec</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">g_l_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g_l_rec</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Rattay_Aberham&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g_na_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g_k_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g_l_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                    <span class="n">g_na_rec</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span>\
                        <span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_gna_RattayAberham</span><span class="p">,</span>\
                        <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">g_k_rec</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span>\
                        <span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_gk_RattayAberham</span><span class="p">,</span>\
                        <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">g_l_rec</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span>\
                       <span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_gl_RattayAberham</span><span class="p">,</span>\
                       <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">g_na_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g_na_rec</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">g_k_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g_k_rec</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">g_l_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g_l_rec</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>   </div>

<div class="viewcode-block" id="unmyelinated.get_membrane_conductance"><a class="viewcode-back" href="../../../nrv.nmod.html#nrv.nmod.unmyelinated.unmyelinated.get_membrane_conductance">[docs]</a>    <span class="k">def</span> <span class="nf">get_membrane_conductance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the membrane voltage at the end of simulation. For internal use only.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">g_mem_rec</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;HH&#39;</span><span class="p">,</span> <span class="s1">&#39;Rattay_Aberham&#39;</span><span class="p">]:</span>
            <span class="n">g_mem_rec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">):</span>
                <span class="n">g_mem_rec</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g_na_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g_k_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>\
                    <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g_l_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">g_mem_rec</span></div>
 
<div class="viewcode-block" id="unmyelinated.get_ionic_conductance"><a class="viewcode-back" href="../../../nrv.nmod.html#nrv.nmod.unmyelinated.unmyelinated.get_ionic_conductance">[docs]</a>    <span class="k">def</span> <span class="nf">get_ionic_conductance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the membrane voltage at the end of simulation. For internal use only.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;HH&#39;</span><span class="p">,</span> <span class="s1">&#39;Rattay_Aberham&#39;</span><span class="p">]:</span>
            <span class="n">g_na_rec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">g_k_rec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">g_l_rec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">):</span>
                <span class="n">g_na_rec</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g_na_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">g_k_rec</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g_k_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">g_l_rec</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g_l_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">g_na_rec</span><span class="p">,</span> <span class="n">g_k_rec</span><span class="p">,</span> <span class="n">g_l_rec</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">results</span> </div>
        
<div class="viewcode-block" id="unmyelinated.set_particules_values_recorders"><a class="viewcode-back" href="../../../nrv.nmod.html#nrv.nmod.unmyelinated.unmyelinated.set_particules_values_recorders">[docs]</a>    <span class="k">def</span> <span class="nf">set_particules_values_recorders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prepare the particule value recording. For internal use only.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;HH&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hhmreclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hhnreclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hhhreclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                    <span class="n">hhm</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_m_hh</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">hhn</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_n_hh</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">hhh</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_h_hh</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">hhmreclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hhm</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">hhnreclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hhn</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">hhhreclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hhh</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Rattay_Aberham&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hhmreclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hhnreclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hhhreclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                    <span class="n">hhm</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_m_RattayAberham</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">hhn</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_n_RattayAberham</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">hhh</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_h_RattayAberham</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">hhmreclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hhm</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">hhnreclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hhn</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">hhhreclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hhh</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Sundt&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hhmreclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hhnreclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hhhreclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                    <span class="n">hhm</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_m_nahh</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">hhn</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_n_borgkdr</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">hhh</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_h_nahh</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">hhmreclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hhm</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">hhnreclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hhn</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">hhhreclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hhh</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Tigerholm&#39;</span><span class="p">:</span>
            <span class="c1"># NAV 1.8</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_nav18_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">h_nav18_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s_nav18_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">u_nav18_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="c1"># NAV 1.9</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_nav19_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">h_nav19_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s_nav19_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="c1"># NATTX - sensitive</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_nattxs_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">h_nattxs_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s_nattxs_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="c1"># K delayed rectifier</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_kdr_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="c1"># K fast channel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_kf_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">h_kf_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="c1"># K slow channel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ns_ks_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nf_ks_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="c1"># Sodium dependent K channel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">w_kna_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="c1"># Hyperpolarization channel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ns_h_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nf_h_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                    <span class="c1"># NAV 1.8</span>
                    <span class="n">m_nav18</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_m_nav1p8</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">h_nav18</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_h_nav1p8</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">s_nav18</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_s_nav1p8</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">u_nav18</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_u_nav1p8</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">m_nav18_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_nav18</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">h_nav18_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h_nav18</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">s_nav18_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s_nav18</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">u_nav18_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u_nav18</span><span class="p">)</span>
                    <span class="c1"># NAV 1.9</span>
                    <span class="n">m_nav19</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_m_nav1p9</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">h_nav19</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_h_nav1p9</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">s_nav19</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_s_nav1p9</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">m_nav19_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_nav19</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">h_nav19_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h_nav19</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">s_nav19_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s_nav19</span><span class="p">)</span>
                    <span class="c1"># NATTX - sensitive</span>
                    <span class="n">m_nattxs</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_m_nattxs</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">h_nattxs</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_h_nattxs</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">s_nattxs</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_s_nattxs</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">m_nattxs_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_nattxs</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">h_nattxs_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h_nattxs</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">s_nattxs_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s_nattxs</span><span class="p">)</span>
                    <span class="c1"># K delayed rectifier</span>
                    <span class="n">n_kdr</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_n_kdrTiger</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">n_kdr_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n_kdr</span><span class="p">)</span>
                    <span class="c1"># K fast channel</span>
                    <span class="n">m_kf</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_m_kf</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">h_kf</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_h_kf</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">m_kf_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_kf</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">h_kf_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h_kf</span><span class="p">)</span>
                    <span class="c1"># K slow channel</span>
                    <span class="n">ns_ks</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_ns_ks</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">nf_ks</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_nf_ks</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ns_ks_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ns_ks</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nf_ks_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nf_ks</span><span class="p">)</span>
                    <span class="c1"># Sodium dependent K channel</span>
                    <span class="n">w_kna</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_w_kna</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">w_kna_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w_kna</span><span class="p">)</span>
                    <span class="c1"># Hyperpolarization channel</span>
                    <span class="n">ns_h</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_ns_h</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">nf_h</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_nf_h</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ns_h_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ns_h</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nf_h_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nf_h</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># should be both Schild_94 or Schild_97</span>
            <span class="c1"># High Threshold long lasting Ca</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">d_can_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f1_can_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f2_can_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="c1"># Low Threshold transient Ca</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">d_cat_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f_cat_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="c1"># Early Transient Outward K</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">p_ka_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">q_ka_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="c1"># Ca activated K</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c_kca_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="c1"># Delayed rectifier K</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_kd_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="c1"># Slowly inactivated K</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x_kds_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y1_kds_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                    <span class="c1"># High Threshold long lasting Ca</span>
                    <span class="n">d_can</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_d_can</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">f1_can</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_f1_can</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">f2_can</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_f2_can</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">d_can_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d_can</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">f1_can_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1_can</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">f2_can_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f2_can</span><span class="p">)</span>
                    <span class="c1"># Low Threshold transient Ca</span>
                    <span class="n">d_cat</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_d_cat</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">f_cat</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_f_cat</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">d_cat_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d_cat</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">f_cat_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f_cat</span><span class="p">)</span>
                    <span class="c1"># Early Transient Outward K</span>
                    <span class="n">p_ka</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_p_ka</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">q_ka</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_q_ka</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">p_ka_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ka</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">q_ka_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q_ka</span><span class="p">)</span>
                    <span class="c1"># Ca activated K</span>
                    <span class="n">c_kca</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_c_kca</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">c_kca_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c_kca</span><span class="p">)</span>
                    <span class="c1"># Delayed rectifier K</span>
                    <span class="n">n_kd</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_n_kd</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">n_kd_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n_kd</span><span class="p">)</span>
                    <span class="c1"># Slowly inactivated K</span>
                    <span class="n">x_kds</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_x_kds</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">y1_kds</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_y1_kds</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">x_kds_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_kds</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">y1_kds_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y1_kds</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Schild_94&#39;</span><span class="p">:</span>
                <span class="c1"># Fast Na</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_naf_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">h_naf_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">l_naf_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
                <span class="c1"># Slow Na</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_nas_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">h_nas_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                        <span class="c1"># Fast Na</span>
                        <span class="n">m_naf</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_m_naf</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                        <span class="n">h_naf</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_h_naf</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                        <span class="n">l_naf</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_l_naf</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">m_naf_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_naf</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">h_naf_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h_naf</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">l_naf_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l_naf</span><span class="p">)</span>
                        <span class="c1"># Slow Na</span>
                        <span class="n">m_nas</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_m_nas</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                        <span class="n">h_nas</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_h_nas</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">m_nas_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_nas</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">h_nas_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h_nas</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1"># should be Schild_94</span>
                <span class="c1"># Fast Na</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_naf_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">h_naf_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
                <span class="c1"># Slow Na</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_nas_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">h_nas_reclist</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsec</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_position_list</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                        <span class="c1"># Fast Na</span>
                        <span class="n">m_naf</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_m_naf97mean</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                        <span class="n">h_naf</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_h_naf97mean</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">m_naf_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_naf</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">h_naf_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h_naf</span><span class="p">)</span>
                        <span class="c1"># Slow Na</span>
                        <span class="n">m_nas</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_m_nas97mean</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                        <span class="n">h_nas</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_h_nas97mean</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unmyelinated_sections</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">m_nas_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_nas</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">h_nas_reclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h_nas</span><span class="p">)</span></div>

<div class="viewcode-block" id="unmyelinated.get_particles_values"><a class="viewcode-back" href="../../../nrv.nmod.html#nrv.nmod.unmyelinated.unmyelinated.get_particles_values">[docs]</a>    <span class="k">def</span> <span class="nf">get_particles_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the particules values at the end of simulation. For internal use only.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;HH&#39;</span><span class="p">,</span> <span class="s1">&#39;Rattay_Aberham&#39;</span><span class="p">,</span> <span class="s1">&#39;Sundt&#39;</span><span class="p">]:</span>
            <span class="n">m_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">n_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">h_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">):</span>
                <span class="n">m_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hhmreclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">n_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hhnreclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">h_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hhhreclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">m_ax</span><span class="p">,</span> <span class="n">n_ax</span><span class="p">,</span> <span class="n">h_ax</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Tigerholm&#39;</span><span class="p">]:</span>
            <span class="n">m_nav18_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">h_nav18_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">s_nav18_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">u_nav18_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">m_nav19_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">h_nav19_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">s_nav19_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">m_nattxs_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">h_nattxs_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">s_nattxs_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">n_kdr_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">m_kf_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">h_kf_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">ns_ks_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">nf_ks_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">w_kna_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">ns_h_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">nf_h_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">):</span>
                <span class="n">m_nav18_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_nav18_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">h_nav18_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_nav18_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">s_nav18_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s_nav18_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">u_nav18_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">u_nav18_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">m_nav19_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_nav19_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">h_nav19_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_nav19_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">s_nav19_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s_nav19_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">m_nattxs_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_nattxs_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">h_nattxs_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_nattxs_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">s_nattxs_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s_nattxs_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">n_kdr_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_kdr_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">m_kf_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_kf_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">h_kf_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_kf_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">ns_ks_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ns_ks_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">nf_ks_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nf_ks_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">w_kna_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w_kna_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">ns_h_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ns_h_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">nf_h_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nf_h_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">m_nav18_ax</span><span class="p">,</span> <span class="n">h_nav18_ax</span><span class="p">,</span> <span class="n">s_nav18_ax</span><span class="p">,</span> <span class="n">u_nav18_ax</span><span class="p">,</span> <span class="n">m_nav19_ax</span><span class="p">,</span> <span class="n">h_nav19_ax</span><span class="p">,</span>\
                <span class="n">s_nav19_ax</span><span class="p">,</span> <span class="n">m_nattxs_ax</span><span class="p">,</span> <span class="n">h_nattxs_ax</span><span class="p">,</span> <span class="n">s_nattxs_ax</span><span class="p">,</span> <span class="n">n_kdr_ax</span><span class="p">,</span> <span class="n">m_kf_ax</span><span class="p">,</span> <span class="n">h_kf_ax</span><span class="p">,</span>\
                <span class="n">ns_ks_ax</span><span class="p">,</span> <span class="n">nf_ks_ax</span><span class="p">,</span> <span class="n">w_kna_ax</span><span class="p">,</span> <span class="n">ns_h_ax</span><span class="p">,</span> <span class="n">nf_h_ax</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># should be &#39;Schild_94&#39; or &#39;Schild_97&#39;</span>
            <span class="n">d_can_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">f1_can_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">f2_can_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">d_cat_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">f_cat_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">p_ka_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">q_ka_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">c_kca_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">n_kd_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">x_kds_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">y1_kds_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">m_naf_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">h_naf_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">m_nas_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="n">h_nas_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">):</span>
                <span class="n">d_can_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">d_can_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">f1_can_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f1_can_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">f2_can_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f2_can_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">d_cat_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">d_cat_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">f_cat_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f_cat_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">p_ka_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_ka_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">q_ka_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">q_ka_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">c_kca_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_kca_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">n_kd_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_kd_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">x_kds_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_kds_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">y1_kds_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y1_kds_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">m_naf_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_naf_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">h_naf_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_naf_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">m_nas_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_nas_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">h_nas_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_nas_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Schild_97&#39;</span><span class="p">:</span>
                <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">d_can_ax</span><span class="p">,</span> <span class="n">f1_can_ax</span><span class="p">,</span> <span class="n">f2_can_ax</span><span class="p">,</span> <span class="n">d_cat_ax</span><span class="p">,</span> <span class="n">f_cat_ax</span><span class="p">,</span> <span class="n">p_ka_ax</span><span class="p">,</span> <span class="n">q_ka_ax</span><span class="p">,</span>\
                    <span class="n">c_kca_ax</span><span class="p">,</span> <span class="n">n_kd_ax</span><span class="p">,</span> <span class="n">x_kds_ax</span><span class="p">,</span> <span class="n">y1_kds_ax</span><span class="p">,</span> <span class="n">m_naf_ax</span><span class="p">,</span> <span class="n">h_naf_ax</span><span class="p">,</span> <span class="n">m_nas_ax</span><span class="p">,</span> <span class="n">h_nas_ax</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1"># should be &#39;Schild 94&#39;</span>
                <span class="n">l_naf_ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_len</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nrec</span><span class="p">):</span>
                    <span class="n">l_naf_ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l_naf_reclist</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">d_can_ax</span><span class="p">,</span> <span class="n">f1_can_ax</span><span class="p">,</span> <span class="n">f2_can_ax</span><span class="p">,</span> <span class="n">d_cat_ax</span><span class="p">,</span> <span class="n">f_cat_ax</span><span class="p">,</span> <span class="n">p_ka_ax</span><span class="p">,</span> <span class="n">q_ka_ax</span><span class="p">,</span>\
                    <span class="n">c_kca_ax</span><span class="p">,</span> <span class="n">n_kd_ax</span><span class="p">,</span> <span class="n">x_kds_ax</span><span class="p">,</span> <span class="n">y1_kds_ax</span><span class="p">,</span> <span class="n">m_naf_ax</span><span class="p">,</span> <span class="n">h_naf_ax</span><span class="p">,</span> <span class="n">l_naf_ax</span><span class="p">,</span>\
                    <span class="n">m_nas_ax</span><span class="p">,</span> <span class="n">h_nas_ax</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">results</span></div></div>
</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    </body>
</html>