<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" />

    <!-- Generated with Sphinx 6.2.1 and Furo 2023.05.20 -->
        <title>nrv.fmod.stimulus - NeuRon Virtualizer (NRV) 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=e6660623a769aa55fea372102b9bf3151b292993" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f0f0f0;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #232629;
  --color-code-foreground: #cccccc;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #232629;
  --color-code-foreground: #cccccc;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">NeuRon Virtualizer (NRV) 1.0.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">NeuRon Virtualizer (NRV) 1.0.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../modules.html">nrv</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of nrv</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../nrv.html">nrv package</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of nrv package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nrv.backend.html">nrv.backend package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrv.fmod.html">nrv.fmod package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrv.nmod.html">nrv.nmod package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrv.optim.html">nrv.optim package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrv.utils.html">nrv.utils package</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <h1>Source code for nrv.fmod.stimulus</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">NRV-Stimulus</span>
<span class="sd">Authors: Florian Kolbl / Roland Giraud / Louis Regnacq / Thomas Couppey / Thomas Couppey</span>
<span class="sd">(c) ETIS - University Cergy-Pontoise - CNRS</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">faulthandler</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">..backend.log_interface</span> <span class="kn">import</span> <span class="n">rise_error</span><span class="p">,</span> <span class="n">rise_warning</span><span class="p">,</span> <span class="n">pass_info</span>
<span class="kn">from</span> <span class="nn">..backend.file_handler</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">..backend.NRV_Class</span> <span class="kn">import</span> <span class="n">NRV_class</span>


<span class="c1"># enable faulthandler to ease &#39;segmentation faults&#39; debug</span>
<span class="n">faulthandler</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>

<span class="c1">###############</span>
<span class="c1">## Functions ##</span>
<span class="c1">###############</span>
<div class="viewcode-block" id="is_stim"><a class="viewcode-back" href="../../../nrv.fmod.html#nrv.fmod.stimulus.is_stim">[docs]</a><span class="k">def</span> <span class="nf">is_stim</span><span class="p">(</span><span class="n">stim</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    check if an object is a stimulus, return True if yes, else False</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    stim : object</span>
<span class="sd">        object to test</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        True it the type is a stimulus object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stim</span><span class="p">,</span> <span class="n">stimulus</span><span class="p">)</span></div>

<div class="viewcode-block" id="set_common_time_series"><a class="viewcode-back" href="../../../nrv.fmod.html#nrv.fmod.stimulus.set_common_time_series">[docs]</a><span class="k">def</span> <span class="nf">set_common_time_series</span><span class="p">(</span><span class="n">stim1</span><span class="p">,</span> <span class="n">stim2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    set two signals at the same time samples, missing samples are reconstructed by holding a value</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    stim1   : stimulus object</span>
<span class="sd">        First stimulus to synchronize</span>
<span class="sd">    stim2   : stimulus object</span>
<span class="sd">        Second object to synchronize</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">stim1</span><span class="o">.</span><span class="n">insert_samples</span><span class="p">(</span><span class="n">stim2</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
    <span class="n">stim2</span><span class="o">.</span><span class="n">insert_samples</span><span class="p">(</span><span class="n">stim1</span><span class="o">.</span><span class="n">t</span><span class="p">)</span></div>

<div class="viewcode-block" id="get_equal_timing_copies"><a class="viewcode-back" href="../../../nrv.fmod.html#nrv.fmod.stimulus.get_equal_timing_copies">[docs]</a><span class="k">def</span> <span class="nf">get_equal_timing_copies</span><span class="p">(</span><span class="n">stim1</span><span class="p">,</span> <span class="n">stim2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    create two stimuli with equal timing as copies of the input ones</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    stim1   : stimulus object</span>
<span class="sd">        First stimulus to synchronize</span>
<span class="sd">    stim2   : stimulus object</span>
<span class="sd">        Second object to synchronize</span>

<span class="sd">    Returns</span>
<span class="sd">    --------</span>
<span class="sd">    stima : stimulus object</span>
<span class="sd">        copie of stim1 with timings from stim1 and stim2</span>
<span class="sd">    stimb : stimulus object</span>
<span class="sd">        copie of stim2 with timings from stim1 and stim2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">stim_a</span> <span class="o">=</span> <span class="n">stimulus</span><span class="p">()</span>
    <span class="n">stim_a</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">stim1</span><span class="o">.</span><span class="n">s</span>
    <span class="n">stim_a</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">stim1</span><span class="o">.</span><span class="n">t</span>
    <span class="n">stim_b</span> <span class="o">=</span> <span class="n">stimulus</span><span class="p">()</span>
    <span class="n">stim_b</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">stim2</span><span class="o">.</span><span class="n">s</span>
    <span class="n">stim_b</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">stim2</span><span class="o">.</span><span class="n">t</span>
    <span class="n">stim_a</span><span class="o">.</span><span class="n">insert_samples</span><span class="p">(</span><span class="n">stim_b</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
    <span class="n">stim_b</span><span class="o">.</span><span class="n">insert_samples</span><span class="p">(</span><span class="n">stim_a</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">stim_a</span><span class="p">,</span> <span class="n">stim_b</span></div>

<div class="viewcode-block" id="datfile_2_stim"><a class="viewcode-back" href="../../../nrv.fmod.html#nrv.fmod.stimulus.datfile_2_stim">[docs]</a><span class="k">def</span> <span class="nf">datfile_2_stim</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.005</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Creates a stimulus from sampled data specified in a .dat file</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fname : str</span>
<span class="sd">        name of the file containing the sampled data</span>
<span class="sd">    dt    : float, optional</span>
<span class="sd">        value of the sampling period, in ms. By default set to 0.005ms</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">stim_1</span> <span class="o">=</span> <span class="n">stimulus</span><span class="p">()</span>
    <span class="c1"># open the dat file and feed the stimulus</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="n">stim_1</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span><span class="o">*</span><span class="n">dt</span>
    <span class="n">stim_1</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">return</span> <span class="n">stim_1</span></div>


<span class="c1">################################</span>
<span class="c1">## Stimulus object definition ##</span>
<span class="c1">################################</span>
<div class="viewcode-block" id="stimulus"><a class="viewcode-back" href="../../../nrv.fmod.html#nrv.fmod.stimulus.stimulus">[docs]</a><span class="k">class</span> <span class="nc">stimulus</span><span class="p">(</span><span class="n">NRV_class</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stimulus class for NRV2,</span>
<span class="sd">    signals are defined as asynchronous signals, with s the values and t as occurence timings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s_init</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instantiation of a stimulus object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s_init  : float</span>
<span class="sd">            initial value of the signal, by default 0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s2">&quot;stimulus&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s_init</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1">## Save and Load mehtods</span>

<div class="viewcode-block" id="stimulus.save_stimulus"><a class="viewcode-back" href="../../../nrv.fmod.html#nrv.fmod.stimulus.stimulus.save_stimulus">[docs]</a>    <span class="k">def</span> <span class="nf">save_stimulus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;stimulus.json&#39;</span><span class="p">):</span>
        <span class="n">rise_warning</span><span class="p">(</span><span class="s1">&#39;save_stimulus is a deprecated method use save&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">fname</span><span class="p">)</span></div>
<div class="viewcode-block" id="stimulus.load_stimulus"><a class="viewcode-back" href="../../../nrv.fmod.html#nrv.fmod.stimulus.stimulus.load_stimulus">[docs]</a>    <span class="k">def</span> <span class="nf">load_stimulus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;stimulus.json&#39;</span><span class="p">):</span>
        <span class="n">rise_warning</span><span class="p">(</span><span class="s1">&#39;load_stimulus is a deprecated method use load&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span></div>

    <span class="c1">############################</span>
    <span class="c1">## basic handling methods ##</span>
    <span class="c1">############################</span>
<div class="viewcode-block" id="stimulus.append"><a class="viewcode-back" href="../../../nrv.fmod.html#nrv.fmod.stimulus.stimulus.append">[docs]</a>    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Append a sample to the signal, internal use only.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s   : float</span>
<span class="sd">            value of the signal to append, numpy array like</span>
<span class="sd">        t   : float</span>
<span class="sd">            time of signal change</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">t</span><span class="p">))</span></div>

<div class="viewcode-block" id="stimulus.concatenate"><a class="viewcode-back" href="../../../nrv.fmod.html#nrv.fmod.stimulus.stimulus.concatenate">[docs]</a>    <span class="k">def</span> <span class="nf">concatenate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t_shift</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Concatenate samples to a signal, internal use only.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s       : float</span>
<span class="sd">            values of signal, numpy array like</span>
<span class="sd">        t       : float</span>
<span class="sd">            time serie of the values, numpy array like</span>
<span class="sd">        t_shift : float</span>
<span class="sd">            time to shift the t values at the end of original signal, by default equal to 0. Here to prevent possible duplicates if the t serie starts with 0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">t_shift</span><span class="p">)</span></div>

<div class="viewcode-block" id="stimulus.len"><a class="viewcode-back" href="../../../nrv.fmod.html#nrv.fmod.stimulus.stimulus.len">[docs]</a>    <span class="k">def</span> <span class="nf">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the length of the signal</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        len : int</span>
<span class="sd">            length of the signal (s and t attribute should have the same length if the signal is not corrupted)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="stimulus.sort"><a class="viewcode-back" href="../../../nrv.fmod.html#nrv.fmod.stimulus.stimulus.sort">[docs]</a>    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sort the signal with increasing timings</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ordered_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">[</span><span class="n">ordered_ind</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">ordered_ind</span><span class="p">]</span></div>

<div class="viewcode-block" id="stimulus.insert_samples"><a class="viewcode-back" href="../../../nrv.fmod.html#nrv.fmod.stimulus.stimulus.insert_samples">[docs]</a>    <span class="k">def</span> <span class="nf">insert_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Insert samples inside a signal and adapt values consequently</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        t   : array, np.array or list</span>
<span class="sd">            time serie of samples to insert, numpy array-like, dosent have to be sorted</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># add the new time values at their place and remove duplicates</span>
        <span class="n">new_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">t</span><span class="p">))))</span>
        <span class="n">new_s</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_t</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">len</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">new_t</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span> <span class="c1"># added sample, hold the last value</span>
                    <span class="n">new_s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>   <span class="c1"># orinal sample, retrieve value in original signal and increment counter</span>
                    <span class="n">new_s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                    <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">new_s</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">new_t</span></div>

    <span class="c1">#####################</span>
    <span class="c1">## special methods ##</span>
    <span class="c1">#####################</span>
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">stim</span> <span class="o">=</span> <span class="n">stimulus</span><span class="p">()</span>
        <span class="n">stim</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
        <span class="n">stim</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span>
        <span class="k">return</span> <span class="n">stim</span>

    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">stim</span> <span class="o">=</span> <span class="n">stimulus</span><span class="p">()</span>
        <span class="n">stim</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span>
        <span class="n">stim</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span>
        <span class="k">return</span> <span class="n">stim</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">stimulus</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">is_stim</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
            <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">get_equal_timing_copies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
            <span class="n">C</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">s</span> <span class="o">+</span> <span class="n">B</span><span class="o">.</span><span class="n">s</span>
            <span class="n">C</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">t</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">C</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="n">C</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span>
        <span class="k">return</span> <span class="n">C</span>

    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">stimulus</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">is_stim</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
            <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">get_equal_timing_copies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
            <span class="n">C</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">s</span> <span class="o">-</span> <span class="n">B</span><span class="o">.</span><span class="n">s</span>
            <span class="n">C</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">t</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">C</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="n">C</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span>
        <span class="k">return</span> <span class="n">C</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">stimulus</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">is_stim</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
            <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">get_equal_timing_copies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
            <span class="n">C</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">s</span> <span class="o">*</span> <span class="n">B</span><span class="o">.</span><span class="n">s</span>
            <span class="n">C</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">t</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">C</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="n">C</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span>
        <span class="k">return</span> <span class="n">C</span>

    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">stimulus</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">is_stim</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
            <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">get_equal_timing_copies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
            <span class="n">C</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">s</span> <span class="o">+</span> <span class="n">A</span><span class="o">.</span><span class="n">s</span>
            <span class="n">C</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">t</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">C</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>
            <span class="n">C</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span>
        <span class="k">return</span> <span class="n">C</span>

    <span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">stimulus</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">is_stim</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
            <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">get_equal_timing_copies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
            <span class="n">C</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">s</span> <span class="o">-</span> <span class="n">A</span><span class="o">.</span><span class="n">s</span>
            <span class="n">C</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">t</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">C</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>
            <span class="n">C</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span>
        <span class="k">return</span> <span class="n">C</span>

    <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">stimulus</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">is_stim</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
            <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">get_equal_timing_copies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
            <span class="n">C</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">s</span><span class="o">*</span><span class="n">A</span><span class="o">.</span><span class="n">s</span>
            <span class="n">C</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">t</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">C</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span>
            <span class="n">C</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span>
        <span class="k">return</span> <span class="n">C</span>

    <span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">stimulus</span><span class="p">()</span>
        <span class="n">C</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">**</span><span class="nb">float</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">C</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">is_stim</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
            <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">get_equal_timing_copies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="n">B</span><span class="o">.</span><span class="n">s</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">B</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="n">b</span><span class="p">:</span>
                    <span class="n">flag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">flag</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span> <span class="c1"># self != b</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">b</span>

    <span class="c1">#######################</span>
    <span class="c1">## signal generators ##</span>
    <span class="c1">#######################</span>
<div class="viewcode-block" id="stimulus.constant"><a class="viewcode-back" href="../../../nrv.fmod.html#nrv.fmod.stimulus.stimulus.constant">[docs]</a>    <span class="k">def</span> <span class="nf">constant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ceat a constant signal</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">            Value of the constant signal</span>
<span class="sd">        start :float</span>
<span class="sd">            starting time of the constant signal, by default set to 0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span></div>

<div class="viewcode-block" id="stimulus.pulse"><a class="viewcode-back" href="../../../nrv.fmod.html#nrv.fmod.stimulus.stimulus.pulse">[docs]</a>    <span class="k">def</span> <span class="nf">pulse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create pulse shape signal samples</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value       : float</span>
<span class="sd">            value of the pulse</span>
<span class="sd">        start       : float</span>
<span class="sd">            starting time of the pulse</span>
<span class="sd">        duration    : float</span>
<span class="sd">            duration of the pulse, optional and by default equal to zero, if non zero value, a point is added at the end of the pulse with the previous value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s_last</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">duration</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s_last</span><span class="p">,</span> <span class="n">start</span> <span class="o">+</span> <span class="n">duration</span><span class="p">)</span></div>

<div class="viewcode-block" id="stimulus.biphasic_pulse"><a class="viewcode-back" href="../../../nrv.fmod.html#nrv.fmod.stimulus.stimulus.biphasic_pulse">[docs]</a>    <span class="k">def</span> <span class="nf">biphasic_pulse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">s_cathod</span><span class="p">,</span> <span class="n">t_stim</span><span class="p">,</span> <span class="n">s_anod</span><span class="p">,</span> <span class="n">t_inter</span><span class="p">,</span> <span class="n">anod_first</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a biphasic pulse waveform</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        start       : float</span>
<span class="sd">            starting time of the waveform, in ms</span>
<span class="sd">        s_cathod    : float</span>
<span class="sd">            cathodic (negative stimulation value) current, in uA</span>
<span class="sd">            WARNING: always positive, the user give here the absolute value</span>
<span class="sd">        t_stim      : float</span>
<span class="sd">            stimulation time, in ms</span>
<span class="sd">        s_anod      : float</span>
<span class="sd">            anodic (positive stimulation value) current and, in uA</span>
<span class="sd">        t_inter     : float</span>
<span class="sd">            inter pulse timing, in ms</span>
<span class="sd">        anod_first  : bool</span>
<span class="sd">            if true, stimulation is anodic and begins with the anodic value and is balanced with cathodic value, else stimuation is cathodic and begins with the cathodic value and is balances with anodic value,</span>
<span class="sd">            by default set to False (cathodic first as most stimulation protocols)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">anod_first</span><span class="p">:</span>
            <span class="n">s_1</span> <span class="o">=</span> <span class="o">-</span> <span class="n">s_cathod</span>
            <span class="n">s_2</span> <span class="o">=</span> <span class="n">s_anod</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s_2</span> <span class="o">=</span> <span class="o">-</span> <span class="n">s_cathod</span>
            <span class="n">s_1</span> <span class="o">=</span> <span class="n">s_anod</span>
        <span class="k">if</span> <span class="n">s_2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">t_balance</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">s_1</span><span class="o">/</span><span class="n">s_2</span><span class="p">)</span><span class="o">*</span><span class="n">t_stim</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">t_balance</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">s_1</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">t_inter</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">s_2</span><span class="p">,</span> <span class="n">t_stim</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">t_balance</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_balance</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_stim</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">s_2</span><span class="p">,</span> <span class="n">t_inter</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">t_balance</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_balance</span><span class="p">)</span></div>

<div class="viewcode-block" id="stimulus.sinus"><a class="viewcode-back" href="../../../nrv.fmod.html#nrv.fmod.stimulus.stimulus.sinus">[docs]</a>    <span class="k">def</span> <span class="nf">sinus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a sinusoidal waveform</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        start       : float</span>
<span class="sd">            starting time of the waveform, in ms</span>
<span class="sd">        duration    : float</span>
<span class="sd">            duration of the waveform, in ms</span>
<span class="sd">        amplitude   : float</span>
<span class="sd">            amplitude of the waveform, in uA</span>
<span class="sd">        freq        : float</span>
<span class="sd">            frequency of the waveform, in kHz</span>
<span class="sd">        offset      : float</span>
<span class="sd">            offset current of the waveform, in uA, by default set to 0</span>
<span class="sd">        phase       : float</span>
<span class="sd">            initial phase of the waveform, in rad, by default set to 0</span>
<span class="sd">        dt          : float</span>
<span class="sd">            sampling time period to generate the sinusoidal shape. If equal to 0, dt is automatically set to match 100 samples per sinusoid period by default set to 0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the pseudo sampling period</span>
        <span class="k">if</span> <span class="n">dt</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">freq</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">freq</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">dt</span><span class="p">)):</span>
            <span class="n">rise_warning</span><span class="p">(</span><span class="s1">&#39;dt too low in stimulus creation, Shannon criterion not respected&#39;</span><span class="p">)</span>
        <span class="n">Nb_points</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
        <span class="c1"># create the signal</span>
        <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">amplitude</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span> <span class="o">+</span> <span class="n">offset</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">start</span><span class="o">+</span><span class="n">duration</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">Nb_points</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">amplitude</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span> <span class="o">+</span> <span class="n">offset</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t_shift</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">start</span><span class="o">+</span><span class="n">duration</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">Nb_points</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">amplitude</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span> <span class="o">+</span> <span class="n">offset</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t_shift</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="stimulus.square"><a class="viewcode-back" href="../../../nrv.fmod.html#nrv.fmod.stimulus.stimulus.square">[docs]</a>    <span class="k">def</span> <span class="nf">square</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a repetitive (periodic) square waveform</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        start       : float</span>
<span class="sd">            starting time of the waveform, in ms</span>
<span class="sd">        duration    : float</span>
<span class="sd">            duration of the waveform, in ms</span>
<span class="sd">        amplitude   : float</span>
<span class="sd">            amplitude of the waveform, in uA</span>
<span class="sd">        freq        : float</span>
<span class="sd">            frequency of the waveform, in kHz</span>
<span class="sd">        offset      : float</span>
<span class="sd">            offset current of the waveform, in uA, by default set to 0</span>
<span class="sd">        dt          : float</span>
<span class="sd">            sampling time period to generate the sinusoidal shape. If equal to 0, dt is automatically set to match 100 samples per sinusoid period by default set to 0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Nb_points</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">Nb_points</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">T</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">freq</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">start</span><span class="o">+</span><span class="n">duration</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">Nb_points</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Nb_points</span><span class="p">)</span>
        <span class="n">point_start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nb_points</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">point_start</span><span class="p">:</span>
                <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">%</span><span class="n">T</span><span class="o">&lt;</span><span class="n">T</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span>
                    <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t_shift</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="stimulus.ramp"><a class="viewcode-back" href="../../../nrv.fmod.html#nrv.fmod.stimulus.stimulus.ramp">[docs]</a>    <span class="k">def</span> <span class="nf">ramp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)),</span> <span class="n">printslope</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a ramp waveform with slop value</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        slope       : float</span>
<span class="sd">            slope of the waveform, in uA.ms-1</span>
<span class="sd">        start       : float</span>
<span class="sd">            starting time of the waveform, in ms</span>
<span class="sd">        duration    : float</span>
<span class="sd">            duration of the waveform, in ms</span>
<span class="sd">        dt          : float</span>
<span class="sd">            sampling time period to generate the sinusoidal shape</span>
<span class="sd">        bounds      : tuple</span>
<span class="sd">            boundary vaues of the ramp signal</span>
<span class="sd">        printslope  : bool, optional</span>
<span class="sd">            if True, the value of the slope is printed on the prompt</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># create the signal</span>
        <span class="k">if</span> <span class="n">printslope</span><span class="p">:</span>
            <span class="n">pass_info</span><span class="p">(</span><span class="s2">&quot;slope = &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">slope</span><span class="p">))</span>
        <span class="n">Nb_points</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">k</span><span class="o">*</span><span class="n">dt</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nb_points</span><span class="p">)])</span>
        <span class="k">if</span> <span class="n">slope</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Nb_points</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Nb_points</span><span class="p">)</span>
        <span class="n">point_start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">point_start</span><span class="p">,</span> <span class="n">Nb_points</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">slope</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">point_start</span><span class="p">)</span><span class="o">*</span><span class="n">slope</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">slope</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">point_start</span><span class="p">)</span><span class="o">*</span><span class="n">slope</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t_shift</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="stimulus.ramp_lim"><a class="viewcode-back" href="../../../nrv.fmod.html#nrv.fmod.stimulus.stimulus.ramp_lim">[docs]</a>    <span class="k">def</span> <span class="nf">ramp_lim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tstart</span><span class="p">,</span> <span class="n">tstop</span><span class="p">,</span> <span class="n">ampstart</span><span class="p">,</span> <span class="n">ampmax</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">printslope</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a ramp waveform with bounds values</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ampstart    : float</span>
<span class="sd">            initiale amplitude of the waveform, in uA</span>
<span class="sd">        ampmax      : float</span>
<span class="sd">            final amplitude of the waveform, in uA</span>
<span class="sd">        tstart      : float</span>
<span class="sd">            starting time of the waveform, in ms</span>
<span class="sd">        tmax        : float</span>
<span class="sd">            starting time of the waveform, in ms</span>
<span class="sd">        duration    : float</span>
<span class="sd">            duration of the waveform, in ms</span>
<span class="sd">        dt          : float</span>
<span class="sd">            sampling time period to generate the sinusoidal shape</span>
<span class="sd">        printslope  : bool, optional</span>
<span class="sd">            if True, the value of the slope is printed on the prompt</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">ampstart</span><span class="o">-</span><span class="n">ampmax</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">tstart</span><span class="o">-</span><span class="n">tstop</span><span class="p">)</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">ampstart</span><span class="p">,</span> <span class="n">ampmax</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">ampstart</span><span class="p">,</span> <span class="n">ampmax</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ramp</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">tstart</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">printslope</span><span class="p">)</span></div></div>
</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    </body>
</html>